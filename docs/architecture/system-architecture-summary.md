# Master Guide 系统架构总结

## 项目概述

Master Guide 是一个技艺传承平台，支持用户在不同领域拥有大师和学徒双重身份，提供实时指导、课程学习和社群互动功能。

## 技术栈选择

### 前端技术栈
- **Vue 3 + Vite**：现代化前端开发框架
- **TypeScript**：类型安全的JavaScript超集
- **Pinia**：Vue 3状态管理
- **Vue Router 4**：路由管理
- **Element Plus**：UI组件库
- **Socket.io-client**：实时通信

### 后端技术栈
- **Go 1.21**：高性能编程语言
- **Gin**：轻量级Web框架
- **PostgreSQL**：关系型数据库
- **Redis**：缓存和会话存储
- **GORM**：ORM框架
- **JWT**：身份认证
- **WebSocket**：实时通信

### 基础设施
- **Docker**：容器化部署
- **阿里云**：云服务提供商
- **OSS**：对象存储服务
- **CDN**：内容分发网络

## 系统架构图

```
┌─────────────────────────────────────────────────────────────┐
│                       前端层 (Frontend)                      │
├─────────────────────────────────────────────────────────────┤
│  Vue 3 + Vite + TypeScript + Element Plus + Socket.io      │
│  ├── 用户界面 (UI Components)                               │
│  ├── 状态管理 (Pinia Store)                                 │
│  ├── 路由管理 (Vue Router)                                  │
│  └── 实时通信 (WebSocket Client)                           │
└─────────────────────────────────────────────────────────────┘
                                │
                                │ HTTP/WebSocket
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                      API网关层 (API Gateway)                 │
├─────────────────────────────────────────────────────────────┤
│  Nginx + Load Balancer + Rate Limiting                     │
│  ├── 请求路由                                              │
│  ├── 负载均衡                                              │
│  ├── 限流控制                                              │
│  └── SSL终止                                               │
└─────────────────────────────────────────────────────────────┘
                                │
                                │ HTTP/WebSocket
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                      应用服务层 (Application)                │
├─────────────────────────────────────────────────────────────┤
│  Go + Gin + GORM + JWT + WebSocket                         │
│  ├── 用户服务 (User Service)                               │
│  ├── 身份管理 (Identity Service)                           │
│  ├── 课程服务 (Course Service)                             │
│  ├── 社群服务 (Community Service)                          │
│  ├── 支付服务 (Payment Service)                            │
│  └── 实时通信 (WebSocket Service)                          │
└─────────────────────────────────────────────────────────────┘
                                │
                                │ Database Connections
                                ▼
┌─────────────────────────────────────────────────────────────┐
│                      数据存储层 (Data Layer)                 │
├─────────────────────────────────────────────────────────────┤
│  PostgreSQL + Redis + OSS + CDN                            │
│  ├── 关系数据 (PostgreSQL)                                 │
│  ├── 缓存数据 (Redis)                                      │
│  ├── 文件存储 (OSS)                                        │
│  └── 内容分发 (CDN)                                        │
└─────────────────────────────────────────────────────────────┘
```

## 核心功能模块

### 1. 身份管理模块
- **双重身份支持**：用户可同时拥有大师和学徒身份
- **身份切换**：无缝切换不同身份
- **权限控制**：基于身份的功能权限管理
- **认证审核**：大师身份资质认证

### 2. 课程管理模块
- **课程创建**：大师创建和管理课程
- **内容管理**：视频、文本、测验等多种内容类型
- **学习跟踪**：学习进度和完成状态
- **评价系统**：课程评价和反馈

### 3. 大师服务模块
- **大师档案**：详细的个人介绍和技能展示
- **预约系统**：一对一指导预约
- **实时指导**：视频通话和实时互动
- **收入管理**：指导费用和收入统计

### 4. 社群互动模块
- **领域圈子**：按专业领域划分的社群
- **动态分享**：学习心得和作品展示
- **问答系统**：专业问题讨论
- **实时通信**：即时消息和通知

## 数据库设计

### 核心数据表
1. **users** - 用户基础信息
2. **user_identities** - 用户身份信息
3. **user_profiles** - 用户档案信息
4. **courses** - 课程信息
5. **course_contents** - 课程内容
6. **learning_records** - 学习记录
7. **circles** - 社群圈子
8. **posts** - 社群动态
9. **comments** - 评论信息
10. **appointments** - 预约信息
11. **reviews** - 评价信息

### 数据关系设计
- 一个用户可以拥有多个身份（大师/学徒）
- 每个身份绑定特定专业领域
- 身份间数据隔离，基础信息共享
- 支持复杂的多对多关系

## 前端架构特点

### 组件化设计
- **通用组件**：按钮、表单、卡片等基础组件
- **业务组件**：大师卡片、课程卡片等业务组件
- **布局组件**：页面布局和导航组件

### 状态管理
- **Pinia Store**：响应式状态管理
- **身份状态**：当前激活身份管理
- **用户状态**：用户信息和权限管理
- **应用状态**：全局应用状态

### 路由设计
- **路由守卫**：身份验证和权限控制
- **懒加载**：按需加载页面组件
- **嵌套路由**：支持复杂页面结构

## 后端架构特点

### 微服务设计
- **服务拆分**：按业务领域拆分服务
- **接口设计**：RESTful API设计
- **数据隔离**：服务间数据隔离
- **服务通信**：HTTP和消息队列

### 数据访问层
- **Repository模式**：数据访问抽象
- **ORM映射**：GORM对象关系映射
- **事务管理**：ACID事务保证
- **缓存策略**：多级缓存设计

### 中间件设计
- **认证中间件**：JWT身份验证
- **限流中间件**：API访问限流
- **日志中间件**：请求日志记录
- **错误处理**：统一错误处理

## 实时通信设计

### WebSocket架构
- **连接管理**：WebSocket连接池
- **消息路由**：消息分发和路由
- **在线状态**：用户在线状态管理
- **房间管理**：群组和私聊房间

### 消息类型
- **系统消息**：通知和提醒
- **聊天消息**：用户间对话
- **状态消息**：在线状态更新
- **信令消息**：视频通话信令

## 安全设计

### 认证授权
- **JWT Token**：无状态身份认证
- **多身份Token**：支持身份切换
- **权限控制**：基于角色的访问控制
- **API限流**：防止恶意请求

### 数据安全
- **数据加密**：敏感数据加密存储
- **传输加密**：HTTPS + WSS
- **输入验证**：防止注入攻击
- **内容审核**：AI + 人工审核

## 性能优化

### 前端优化
- **代码分割**：按路由和组件分割
- **懒加载**：图片和组件懒加载
- **缓存策略**：浏览器缓存优化
- **CDN加速**：静态资源CDN分发

### 后端优化
- **数据库优化**：索引和查询优化
- **缓存策略**：多级缓存架构
- **连接池**：数据库连接池管理
- **异步处理**：消息队列处理

## 监控运维

### 系统监控
- **性能监控**：Prometheus + Grafana
- **日志管理**：ELK Stack
- **告警系统**：钉钉/邮件告警
- **链路追踪**：分布式链路追踪

### 部署架构
- **容器化部署**：Docker容器化
- **负载均衡**：Nginx负载均衡
- **自动扩缩容**：基于负载自动扩缩容
- **蓝绿部署**：零停机部署

## 技术优势

### 前端优势
- **开发体验**：Vite提供极速的开发体验
- **类型安全**：TypeScript确保代码质量
- **组件化**：Element Plus提供丰富的UI组件
- **状态管理**：Pinia提供简洁的状态管理
- **实时通信**：Socket.io支持实时功能

### 后端优势
- **高性能**：Go的并发模型和Gin的轻量级设计
- **数据一致性**：PostgreSQL的ACID事务支持
- **缓存效率**：Redis的高性能缓存和会话管理
- **实时通信**：WebSocket支持实时消息推送
- **安全性**：JWT认证、密码加密、限流保护

## 扩展性设计

### 水平扩展
- **负载均衡**：Nginx负载均衡
- **服务网格**：Istio服务网格
- **数据库分片**：读写分离、分库分表
- **缓存集群**：Redis集群

### 垂直扩展
- **资源监控**：CPU、内存、磁盘监控
- **自动扩缩容**：基于负载自动扩缩容
- **资源优化**：定期资源使用分析
- **成本控制**：云资源成本优化

## 开发计划

### 第一阶段：基础架构（1个月）
- 搭建基础开发环境
- 实现用户认证系统
- 建立基础数据模型
- 部署CI/CD流水线

### 第二阶段：核心功能（2个月）
- 实现双重身份管理
- 开发课程管理系统
- 实现基础社群功能
- 集成支付系统

### 第三阶段：高级功能（2个月）
- 实现实时通信功能
- 开发AI推荐系统
- 完善内容审核机制
- 性能优化和监控

## 总结

Master Guide平台采用现代化的微服务架构，使用Vue 3 + Go技术栈，具备良好的可扩展性、安全性和性能。通过合理的服务拆分、数据设计和部署策略，能够支持大规模用户并发访问和复杂的业务需求。

### 核心特色
- **双重身份**：支持用户在不同领域拥有大师和学徒身份
- **实时通信**：WebSocket支持实时视频通话和消息推送
- **社群互动**：专业领域圈子，支持身份标识的互动
- **技术先进**：Vue 3 + Go现代化技术栈

### 技术架构
- **前端**：Vue 3 + Vite + TypeScript + Element Plus
- **后端**：Go + Gin + PostgreSQL + Redis + WebSocket
- **部署**：Docker + 阿里云 + CI/CD

该技术选型方案确保了系统的性能、可扩展性和可维护性，为用户提供流畅的学习和社交体验。 